/*!
 * Selectron 2: Accessible, lightweight <select> replacement
 * @requires jQuery v1.7.0 or above
 *
 * https://github.com/illfittingshoes/selectron2
 *
 * Copyright (c) 2012-2015 Joe Shirley
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 * Version: 2.0.0
 */!function(a){"use strict";var d="function"==typeof Object.create?!0:!1;Object.create="function"==typeof Object.create?Object.create:function(a){return a};var e={defaults:{autoWidth:!0,inheritWidth:!1,inheritPosition:!1,classes:""},init:function(b,c,d){var e=a(b);return this.selectElement=b,this.metadata=e.data("selectron"),this.settings=this.setSettings(c,d),this.storeOptionItems(),this.$selectronElement=this.generateSelectron(),this.replaceSelectWithSelectron(),e.data("selectronObject",this),this.$selectronElement.data("selectronObject",this),this},update:function(a,b){return this.settings=this.setSettings(a,b),this.applyStyleSettings(this.$selectronElement),this},setSettings:function(b,c){return c?a.extend({},this.defaults,b):a.extend({},this.defaults,b,this.metadata)},storeOptionItems:function(){var b=this,c=a(this.selectElement);b.optionItems=[],c.children("option").each(function(c){var d=a(this);b.optionItems[c]={element:this,label:d.attr("data-label")||d.text()}})},generateSelectron:function(){var b=a(this.selectElement),c="",d="",e=b[0].selectedIndex,f=this.optionItems[e].label;return a.each(this.optionItems,function(a){var b=a===e,c=b?"selectron__li selectron__li--selected":"selectron__li";d+='<li class="'+c+'" data-index="'+a+'">'+'<span class="selectron__li__inner">'+this.label+"</span>"+"</li>"}),c='<div class="selectron"><div class="selectron__selected"><div class="selectron__selected__inner">'+f+'<span class="selectron__selected__indicator"></span>'+"</div>"+"</div>"+'<div class="selectron__listWrapper">'+'<ul class="selectron__list">'+d+"</ul>"+"</div>"+"</div>",a(c)},replaceSelectWithSelectron:function(){var b=a(this.selectElement);this.applyStyleSettings(this.$selectronElement),this.$selectronElement.insertAfter(b),b.css({position:"absolute",left:"-9999em"})},applyStyleSettings:function(b){function e(){function k(){g=parseInt(j.css("border-left-width"),10),h=parseInt(j.css("border-right-width"),10),d=j.outerWidth(),a=i.find(".selectron__selected").outerWidth(),i.remove(),b.width(a>d?a:d)}var a=0,d=0,g=0,h=0,i=b.clone().css("visibility","hidden"),j=i.find(".selectron__listWrapper");return i.css("width","auto"),j.css({display:"block",position:"static"}),j.find(".selectron__list").css({display:"block",position:"static"}),i.find("*").css("width","auto"),i.insertAfter(c),setTimeout(k,0)}var c=a(this.selectElement),d=this.settings;d.classes.length>0&&b.addClass(d.classes),d.inheritWidth?b.width(c.width()):d.autoWidth&&e()}},f=Object.create(e);f.activate=function(){var b=this;a("html").on("mousedown.selectron mouseup.selectron click.selectron",".selectron",function(a){b.handleSelectronClick(a,this)}),a("html").on("focusout.selectron focusin.selectron change.selectron keydown.selectron","select",function(c){var d=a(c.target).data("selectronObject");d&&("keydown"===c.type&&b.handleSelectInteraction(c,d),b.reflectSelectStatus(c,d))}),a("html").on("mousedown.selectron",function(a){b.handleGlobalClick(a)})},f.showList=function(a){a.addClass("selectron--shown")},f.hideLists=function(b){var c=b||".selectron--shown";a(c).removeClass("selectron--shown")},f.focusSelect=function(b){var c=a(b.selectElement);a(document.activeElement).is(c)||c[0].focus()},f.getEventSource=function(a){var b="",c=a.which;switch(c){case 1:b="leftMouse";break;case 9:b="tabKey";break;case 13:b="enterKey";break;case 27:b="escapeKey"}return b},f.handleSelectronClick=function(b,c){var k,l,d=this,e=b.type,f=d.getEventSource(b),g=a(b.target),h=a(c),i=g.is(".selectron__li")||g.parents(".selectron__li").length>0?!0:!1,j=h.data("selectronObject");"leftMouse"===f&&(b.stopPropagation(),b.preventDefault(),"mousedown"===e?(d.focusSelect(j),i||(d.hideLists(a(".selectron").not(c)),h.is(".selectron--shown")?d.hideLists(h[0]):d.showList(h))):"mouseup"===e&&i&&(l=a(j.selectElement),k=g.is(".selectron__li")?g:g.parents(".selectron__li"),l.prop("selectedIndex",k.attr("data-index")),l.trigger("change"),d.hideLists(h[0])))},f.handleGlobalClick=function(b){var c=this.getEventSource(b),d=a(b.target);"leftMouse"===c&&!d.is(".selectron")&&d.parents(".selectron").length<1&&this.hideLists()},f.handleSelectInteraction=function(a,b){var c=this.getEventSource(a);("tabKey"===c||"escapeKey"===c||"enterKey"===c)&&this.hideLists(b.$selectronElement[0])},f.reflectSelectStatus=function(b,c){var i,d=c.selectElement,e=c.$selectronElement,h=(this.getEventSource(b),"");"focusin"===b.type?e.addClass("selectron--focused"):"focusout"===b.type?e.removeClass("selectron--focused"):("change"===b.type||"keydown"===b.type)&&(i=a(d).prop("selectedIndex"),setTimeout(function(){var b=a(d);i=b.prop("selectedIndex"),h=c.optionItems[i].label,e.find(".selectron__selected").html(h+'<span class="selectron__selected__indicator"></span>'),e.find("li").removeClass("selectron__li--selected").parent().find("[data-index="+i+"]").addClass("selectron__li--selected")},0))},d?(a.fn.selectron=function(b){function f(b,c,d){var g=(a(b),a(b).data("selectronObject"));return g?g.update(c,d):Object.create(e).init(b,c)}var d=this;return d.each(function(){var c=this,d=a(c);d.is("select")?f(this,b):d.find("select").length>0&&d.find("select").each(function(){f(this,b)})})},a(function(){f.activate(),a("select[data-selectron]").selectron()})):a.fn.selectron=function(){}}(jQuery,window);